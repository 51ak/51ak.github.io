<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>21个常用的PHP函数代码段</title>
<link href="../../img/main.css" rel="stylesheet" type="text/css" />
<script src="../../img/daohang.js" type="text/javascript"></script>
<meta name="description" content="给大家分享21个常用的php函数代码段，内容如下：<br/>1.php可阅读随机字符串<br/>此代码将创建一个可阅读的字符串，使其更接近词典中的单词，实用且具有密码验证功能。<br/>/***************@length&amp;ndash;lengthofrandom&nbsp;string(mustbeamultipleof2)*************21个常用的PHP函数代码段" />

</head>

<body>

<div id="container">
  <div id="header">
<div class="dh-logo cls"> <div class="dh-logo-logo" ><a href="#"><img src="../../img/logo.gif" alt="数据库管理员DBA学习网站  LOGO"  width="251" height="58" /></a></div><div class="dh-logo-ac" id="topbar"><div class="dh-logo-nav">    <span class="f_black">Tips</span>： 亲爱的<span class="f_333" title="注：网站的访客">GUEST</span>用户，系统已为你<span class="f_333" title="注：不解释">GRANT</span>了<span class="f_333" title="注：可以查看网站上的所有文章">SELECT</span>,<a href="/add.aspx" title="注：可以发表文章" rel="nofollow">INSERT</a> 权限 </div> </div></div>
<div id="topMain"><div id="top"><ul class="nav"><li><a href="../../index.htm">网站首页</a></li><li><a  href="../sqlserver/l_1_1.htm" title="SQLServer">SQLServer</a></li><li><a  href="../Oracle/l_7_1.htm" title="Oracle">Oracle</a></li><li><a  href="../mysql/l_13_1.htm" title="MySQL">MySQL</a></li><li><a href="../othersql/l_19_1.htm" class="hover"　title="其他数据库">其他数据库</a></li><li><a  href="../yunwei/l_26_1.htm" title="系统运维">系统运维</a></li><li><a  href="../kaoshi/l_34_1.htm" title="DBA考试">DBA考试</a></li><li><a  href="../dbahuati/l_39_1.htm" title="DBA话题">DBA话题</a></li></ul><ul class="sub"><li><a  href="../nosql/l_20_1.htm" title="NoSQL">NoSQL</a>|</li><li><a  href="../sysbase/l_21_1.htm" title="Sybase">Sybase</a>|</li><li><a  href="../db2/l_22_1.htm" title="DB2">DB2</a>|</li><li><a  href="../access/l_23_1.htm" title="Access"><span class="zc_666">Access</span></a>|</li><li><a  href="../infomix/l_24_1.htm" title="Informix">Informix</a>|</li><li><a  href="../sqlsql/l_25_1.htm" title="其他">其他</a>|</li></ul></div></div>
<br class="clearfloat" />

  </div>
    <div class="local_daohang">您现在的位置: <a href="../../">首页</a> &nbsp;&gt;&nbsp;<a href="../othersql/l_19_1.htm">其他数据库</a>&nbsp;&gt;&nbsp;<a href="../access/l_23_1.htm">Access</a></div>
  <div id="sidebar1">

  
  <div class='div_tab_tab'>
	<div id="div_login_title">通行证登录</div>
          <div id="div_login"> <iframe src="../../page/login.html" frameBorder="0" width="100%"  scrolling="no" height="190"></iframe>  
              &nbsp;</div>     
  </div>
    
  
   <div  class='div_tab_tab'>
  <div id="div_ran" > <span>【在线问答】</span><br /><a href="#" >[{类型}] {题干，这里会显示问题的标题}<br />点击进入答题>></a>
	</div>
  </div>
  
     

    <!-- end #sidebar1 --></div>
  <div id="mainContent">
  		
          
                        <div id="contentdiv">                            
                     <div id="atTitle"><h1>21个常用的PHP函数代码段</h1></div>
					<div id="atSource"> 作者：[网上资料 ] </div>
					
                    <div id="viewcontent">
                   给大家分享21个常用的PHP函数代码段，内容如下：<br />1. PHP可阅读随机字符串<br />此代码将创建一个可阅读的字符串，使其更接近词典中的单词，实用且具有密码验证功能。<br />/***************@length &amp;ndash; length of random&nbsp;string (must be a multiple of 2)**************/function readable_random_string($length = 6){$conso=array(“b”,”c”,”d”,”f”,”g”,”h”,”j”,”k”,”l”,“m”,”n”,”p”,”r”,”s”,”t”,”v”,”w”,”x”,”y”,”z”);$vocal=array(“a”,”e”,”i”,”o”,”u”);$password=”";srand ((double)microtime()*1000000);$max = $length/2;for($i=1; $i&lt;=$max; $i++){$password.=$conso[rand(0,19)];$password.=$vocal[rand(0,4)];}return $password;}<br />2. PHP生成一个随机字符串<br />如果不需要可阅读的字符串，使用此函数替代，即可创建一个随机字符串，作为用户的随机密码等。<br />/**************@l – length of random string*/function generate_rand($l){$c= “ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789″;srand((double)microtime()*1000000);for($i=0; $i&lt;$l; $i++) {$rand.= $c[rand()%strlen($c)];}return $rand;}<br />3. PHP编码电子邮件地址<br />使用此代码，可以将任何电子邮件地址编码为&nbsp;html&nbsp;字符实体，以防止被垃圾邮件程序收集。<br />function encode_email($email=’info@domain.com’, $linkText=’Contact Us’, $attrs =’class=”emailencoder”‘ ){// remplazar aroba y puntos$email = str_replace(‘@’, ‘&amp;#64;’, $email);$email = str_replace(‘.’, ‘&amp;#46;’, $email);$email = str_split($email, 5);<br />$linkText = str_replace(‘@’, ‘&amp;#64;’, $linkText);$linkText = str_replace(‘.’, ‘&amp;#46;’, $linkText);$linkText = str_split($linkText, 5);<br />$part1 = ‘&lt;a href=”ma’;$part2 = ‘ilto&amp;#58;’;$part3 = ‘” ‘. $attrs .’ &gt;’;$part4 = ‘&lt;/a&gt;’;<br />$encoded = ‘&lt;script type=”text/javascript”&gt;’;$encoded .= “document.write(‘$part1′);”;$encoded .= “document.write(‘$part2′);”;foreach($email as $e){$encoded .= “document.write(‘$e’);”;}$encoded .= “document.write(‘$part3′);”;foreach($linkText as $l){$encoded .= “document.write(‘$l’);”;}$encoded .= “document.write(‘$part4′);”;$encoded .= ‘&lt;/script&gt;’;<br />return $encoded;}<br />4. PHP验证邮件地址<br />电子邮件验证也许是中最常用的网页表单验证，此代码除了验证电子邮件地址，也可以选择检查邮件域所属&nbsp;DNS&nbsp;中的 MX 记录，使邮件验证功能更加强大。<br />function is_valid_email($email, $test_mx = false){if(eregi(“^([_a-z0-9-]+)(\.[_a-z0-9-]+)*@([a-z0-9-]+)(\.[a-z0-9-]+)*(\.[a-z]{2,4})$”, $email))if($test_mx){list($username, $domain) = split(“@”, $email);return&nbsp;getmxrr($domain, $mxrecords);}elsereturn true;elsereturn false;}<br />5. PHP列出目录内容<br />function list_files($dir){if(is_dir($dir)){if($handle = opendir($dir)){while(($file = readdir($handle)) !== false){if($file != “.” &amp;&amp; $file != “..” &amp;&amp; $file != “Thumbs.db”){echo ‘&lt;a target=”_blank” href=”‘.$dir.$file.’”&gt;’.$file.’&lt;/a&gt;&lt;br&gt;’.”\n”;}}closedir($handle);}}}<br />6. PHP销毁目录<br />删除一个目录，包括它的内容。<br />/******@dir – Directory to destroy*@virtual[optional]- whether a virtual directory*/function destroyDir($dir, $virtual = false){$ds = DIRECTORY_SEPARATOR;$dir = $virtual ? realpath($dir) : $dir;$dir = substr($dir, -1) == $ds ? substr($dir, 0, -1) : $dir;if (is_dir($dir) &amp;&amp; $handle = opendir($dir)){while ($file = readdir($handle)){if ($file == ‘.’ || $file == ‘..’){continue;}elseif (is_dir($dir.$ds.$file)){destroyDir($dir.$ds.$file);}else{unlink($dir.$ds.$file);}}closedir($handle);rmdir($dir);return true;}else{return false;}}<br />7. PHP解析&nbsp;JSON 数据<br />与大多数流行的&nbsp;Web&nbsp;服务如 twitter 通过开放 API 来提供数据一样，它总是能够知道如何解析 API 数据的各种传送格式，包括&nbsp;JSON，XML&nbsp;等等。<br />$json_string=’{“id”:1,”name”:”foo”,”email”:”foo@foobar.com”,”interest”:["wordpress","php"]} ‘;$obj=json_decode($json_string);echo $obj-&gt;name; //prints fooecho $obj-&gt;interest[1]; //prints php<br />8. PHP解析 XML 数据<br />//xml string$xml_string=”&lt;?xml version=’1.0′?&gt;&lt;users&gt;&lt;user id=’398′&gt;&lt;name&gt;Foo&lt;/name&gt;&lt;email&gt;foo@bar.com&lt;/name&gt;&lt;/user&gt;&lt;user id=’867′&gt;&lt;name&gt;Foobar&lt;/name&gt;&lt;email&gt;foobar@foo.com&lt;/name&gt;&lt;/user&gt;&lt;/users&gt;”;<br />//load the xml string using simplexml$xml = simplexml_load_string($xml_string);<br />//loop through the each node of userforeach ($xml-&gt;user as $user){//access&nbsp;attributeecho $user['id'], ‘ ‘;//subnodes are accessed by -&gt;&nbsp;operatorecho $user-&gt;name, ‘ ‘;echo $user-&gt;email, ‘&lt;br /&gt;’;}<br />9. PHP创建日志缩略名<br />创建用户友好的日志缩略名。<br />function create_slug($string){$slug=preg_replace(‘/[^A-Za-z0-9-]+/’, ‘-’, $string);return $slug;}<br />10. PHP获取客户端真实 IP 地址<br />该函数将获取用户的真实 IP 地址，即便他使用代理服务器。<br />function getRealIpAddr(){if (!emptyempty($_SERVER['HTTP_CLIENT_IP'])){$ip=$_SERVER['HTTP_CLIENT_IP'];}elseif (!emptyempty($_SERVER['HTTP_X_FORWARDED_FOR']))//to check ip is pass from proxy{$ip=$_SERVER['HTTP_X_FORWARDED_FOR'];}else{$ip=$_SERVER['REMOTE_ADDR'];}return $ip;}<br />11. PHP强制性文件下载<br />为用户提供强制性的文件下载功能。<br />/*********************@file – path to file*/function force_download($file){if ((isset($file))&amp;&amp;(file_exists($file))) {header(“Content-length: “.filesize($file));header(‘Content-Type:&nbsp;application/octet-stream’);header(‘Content-Disposition: attachment; filename=”‘ . $file . ‘”‘);readfile(“$file”);} else {echo “No file&nbsp;selected”;}}<br />12. PHP创建标签云<br />function getCloud( $data = array(), $minFontSize = 12, $maxFontSize = 30 ){$minimumCount = min( array_values( $data ) );$maximumCount = max( array_values( $data ) );$spread = $maximumCount – $minimumCount;$cloudHTML&nbsp;= ”;$cloudTags = array();<br />$spread == 0 &amp;&amp; $spread = 1;<br />foreach( $data as $tag =&gt; $count ){$size = $minFontSize + ( $count – $minimumCount )* ( $maxFontSize – $minFontSize ) / $spread;$cloudTags[] = ‘&lt;a style=”font-size: ‘ . floor( $size ) . ‘px’. ‘” href=”#” title=”\” . $tag .‘\’ returned a count of ‘ . $count . ‘”&gt;’.&nbsp;htmlspecialchars( stripslashes( $tag ) ) . ‘&lt;/a&gt;’;}<br />return join( “\n”, $cloudTags ) . “\n”;}/****************************** Sample usage ***/$arr = Array(‘Actionscript’ =&gt; 35, ‘Adobe’ =&gt; 22, ‘Array’ =&gt; 44, ‘Background’ =&gt; 43,‘Blur’ =&gt; 18, ‘Canvas’ =&gt; 33, ‘Class’ =&gt; 15, ‘Color Palette’ =&gt; 11, ‘Crop’ =&gt; 42,‘Delimiter’ =&gt; 13, ‘Depth’ =&gt; 34, ‘Design’ =&gt; 8, ‘Encode’ =&gt; 12, ‘Encryption’ =&gt; 30,‘Extract’ =&gt; 28, ‘Filters’ =&gt; 42);echo getCloud($arr, 12, 36);<br />13. PHP寻找两个字符串的相似性<br />PHP 提供了一个极少使用的 similar_text 函数，但此函数非常有用，用于比较两个字符串并返回相似程度的百分比。<br />similar_text($string1, $string2, $percent);//$percent will have the percentage of similarity<br />14. PHP在应用程序中使用 Gravatar 通用头像<br />随着 WordPress 越来越普及，Gravatar 也随之流行。由于 Gravatar 提供了易于使用的 API，将其纳入应用程序也变得十分方便。<br />/*******************@email – Email address to show gravatar for*@size – size of gravatar*@default – URL of default gravatar to use*@rating – rating of Gravatar(G, PG, R, X)*/function show_gravatar($email, $size, $default, $rating){echo ‘&lt;img src=”http://www.gravatar.com/avatar.php?gravatar_id=’.md5($email).‘&amp;default=’.$default.’&amp;size=’.$size.’&amp;rating=’.$rating.’” width=”‘.$size.’px”height=”‘.$size.’px” /&gt;’;}<br />15. PHP在字符断点处截断文字<br />所谓断字 (word break)，即一个单词可在转行时断开的地方。这一函数将在断字处截断字符串。<br />// Original PHP code by Chirp Internet: www.chirp.com.au// Please acknowledge use of this code by including this header.function myTruncate($string, $limit, $break=”.”, $pad=”…”) {// return with no change if string is shorter than $limitif(strlen($string) &lt;= $limit)return $string;<br />// is $break present between $limit and the end of the string?if(false !== ($breakpoint = strpos($string, $break, $limit))) {if($breakpoint &lt; strlen($string) – 1) {$string = substr($string, 0, $breakpoint) . $pad;}}return $string;}/***** Example ****/$short_string=myTruncate($long_string, 100, ‘ ‘);<br />16. PHP文件 Zip 压缩<br />/* creates a compressed zip file */function create_zip($files = array(),$destination = ”,$overwrite = false) {//if the zip file already exists and overwrite is false, return falseif(file_exists($destination) &amp;&amp; !$overwrite) { return false; }//vars$valid_files = array();//if files were passed in…if(is_array($files)) {//cycle through each fileforeach($files as $file) {//make sure the file existsif(file_exists($file)) {$valid_files[] = $file;}}}//if we have good files…if(count($valid_files)) {//create the archive$zip = new ZipArchive();if($zip-&gt;open($destination,$overwrite ? ZIPARCHIVE::OVERWRITE : ZIPARCHIVE::CREATE) !== true) {return false;}//add the filesforeach($valid_files as $file) {$zip-&gt;addFile($file,$file);}//debug//echo ‘The zip archive contains ‘,$zip-&gt;numFiles,’ files with a status of ‘,$zip-&gt;status;<br />//close the zip — done!$zip-&gt;close();<br />//check to make sure the file existsreturn file_exists($destination);}else{return false;}}/***** Example Usage ***/$files=array(‘file1.jpg’, ‘file2.jpg’, ‘file3.gif’);create_zip($files, ‘myzipfile.zip’, true);<br />17. PHP解压缩 Zip 文件<br />/***********************@file – path to zip file*@destination – destination directory for unzipped files*/function unzip_file($file, $destination){// create object$zip = new ZipArchive() ;// open archiveif ($zip-&gt;open($file) !== TRUE) {die (’Could not open archive’);}// extract contents to destination directory$zip-&gt;extractTo($destination);// close archive$zip-&gt;close();echo ‘Archive extracted to directory’;}<br />18. PHP为 URL 地址预设 http 字符串<br />有时需要接受一些表单中的网址输入，但用户很少添加 http:// 字段，此代码将为网址添加该字段。<br />if (!preg_match(“/^(http|ftp):/”, $_POST['url'])) {$_POST['url'] = ‘http://’.$_POST['url'];}<br />19. PHP将网址字符串转换成超级链接<br />该函数将 URL 和 E-mail 地址字符串转换为可点击的超级链接。<br />function makeClickableLinks($text) {$text = eregi_replace(‘(((f|ht){1}tp://)[-a-zA-Z0-9@:%_+.~#?&amp;//=]+)’,‘&lt;a href=”\1″&gt;\1&lt;/a&gt;’, $text);$text = eregi_replace(‘([[:space:]()[{}])(www.[-a-zA-Z0-9@:%_+.~#?&amp;//=]+)’,‘\1&lt;a href=”http://\2″&gt;\2&lt;/a&gt;’, $text);$text = eregi_replace(‘([_.0-9a-z-]+@([0-9a-z][0-9a-z-]+.)+[a-z]{2,3})’,‘&lt;a href=”mailto:\1″&gt;\1&lt;/a&gt;’, $text);<br />return $text;}<br />20. PHP调整图像尺寸<br />创建图像缩略图需要许多时间，此代码将有助于了解缩略图的逻辑。<br />/***********************@filename – path to the image*@tmpname – temporary path to thumbnail*@xmax – max width*@ymax – max height*/function resize_image($filename, $tmpname, $xmax, $ymax){$ext = explode(“.”, $filename);$ext = $ext[count($ext)-1];<br />if($ext == “jpg” || $ext == “jpeg”)$im = imagecreatefromjpeg($tmpname);elseif($ext == “png”)$im = imagecreatefrompng($tmpname);elseif($ext == “gif”)$im = imagecreatefromgif($tmpname);<br />$x = imagesx($im);$y = imagesy($im);<br />if($x &lt;= $xmax &amp;&amp; $y &lt;= $ymax)return $im;<br />if($x &gt;= $y) {$newx = $xmax;$newy = $newx * $y / $x;}else {$newy = $ymax;$newx = $x / $y * $newy;}<br />$im2 = imagecreatetruecolor($newx, $newy);imagecopyresized($im2, $im, 0, 0, 0, 0, floor($newx), floor($newy), $x, $y);return $im2;}<br />21. PHP检测&nbsp;ajax&nbsp;请求<br />大多数的 JavaScript&nbsp;框架如&nbsp;jquery，Mootools 等，在发出 Ajax 请求时，都会发送额外的 HTTP_X_REQUESTED_WITH 头部信息，头当他们一个ajax请求，因此你可以在服务器端侦测到 Ajax 请求。<br />if(!emptyempty($_SERVER['HTTP_X_REQUESTED_WITH']) &amp;&amp; strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == ‘xmlhttprequest’){//If AJAX Request Then}else{//something else}<br />
																	|
</div>  
 
                    </div>
                    <hr class="hrdt" />	
<div id="res"></div>
                        
                        </div>

<!-- end #mainContent --></div>
	<!-- 这个用于清除浮动的元素应当紧跟 #mainContent div 之后，以便强制 #container div 包含所有的子浮动 -->
	<br class="clearfloat" />

      
   
	<div id="footer">
  <ul class="green_1">		<li><div id="slogo"></div></li>		<li><div id="bline"></div></li>		<li><div id="binfo">网站名称：数据库DBA学习网站 www.580top.com<br />网络维护：51ak(微信:sohu91) <br /></div></li>	</ul>
   <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id:"K2Iiv8isAYH4TLPh",ck:"K2Iiv8isAYH4TLPh"})</script>
  <!-- end #footer --></div>
  <!-- end #footer --></div>
<!-- end #container --></div>
</body>
</html>
